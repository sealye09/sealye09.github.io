!function(e){"use strict";class t{constructor(){this.storageKey="blog-theme",this.darkClass="dark",this.lightClass="light",this.currentTheme="light",this.observers=[],this.init()}init(){try{const e=this.getStoredTheme(),t=this.getSystemTheme();this.currentTheme=e||t,this.applyTheme(this.currentTheme),this.watchSystemTheme(),this.bindThemeToggleButtons()}catch(e){}}getStoredTheme(){try{return localStorage.getItem(this.storageKey)}catch(e){return null}}getSystemTheme(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}applyTheme(e){try{const t=document.documentElement,r=this.currentTheme;t.classList.remove(r),t.setAttribute("data-theme",e),this.currentTheme=e,this.saveTheme(e),this.updateToggleButtonState(e),this.notifyObservers(e,r)}catch(e){}}saveTheme(e){try{localStorage.setItem(this.storageKey,e)}catch(e){}}toggleTheme(){const e="dark"===this.currentTheme?"light":"dark";return this.applyTheme(e),e}setTheme(e){return("dark"===e||"light"===e)&&(this.applyTheme(e),!0)}watchSystemTheme(){if(!window.matchMedia)return;const e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{if(!this.getStoredTheme()){const t=e.matches?"dark":"light";this.applyTheme(t)}};e.addListener?e.addListener(t):e.addEventListener&&e.addEventListener("change",t)}bindThemeToggleButtons(){[document.getElementById("theme-toggle"),document.getElementById("mobile-theme-toggle")].forEach(e=>{e&&(e.removeEventListener("click",this.handleThemeToggle),e.addEventListener("click",this.handleThemeToggle.bind(this)),this.updateToggleButtonState(this.currentTheme,e))})}handleThemeToggle(e){e.preventDefault(),this.toggleTheme()}updateToggleButtonState(e,t=null){(t?[t]:[document.getElementById("theme-toggle"),document.getElementById("mobile-theme-toggle")]).forEach(t=>{if(!t)return;const r=t.querySelector(".icon-sun"),s=t.querySelector(".icon-moon");r&&s&&("dark"===e?(r.style.display="none",s.style.display="block"):(r.style.display="block",s.style.display="none")),t.setAttribute("aria-label","dark"===e?"切换到亮色主题":"切换到暗色主题")})}addObserver(e){"function"==typeof e&&this.observers.push(e)}removeObserver(e){const t=this.observers.indexOf(e);t>-1&&this.observers.splice(t,1)}notifyObservers(e,t){this.observers.forEach(r=>{try{r(e,t)}catch(e){}})}getCurrentTheme(){return this.currentTheme}resetTheme(){try{localStorage.removeItem(this.storageKey);const e=this.getSystemTheme();this.applyTheme(e)}catch(e){}}isDarkMode(){return"dark"===this.currentTheme}isLightMode(){return"light"===this.currentTheme}}const r=new t;e.BlogTheme={ThemeManager:t,manager:r,create:()=>new t}}("undefined"!=typeof window?window:global);